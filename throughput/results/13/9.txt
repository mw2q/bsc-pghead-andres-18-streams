BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  273531889.06947
 ALGERIA                   |   1997 | 458821418.787709
 ALGERIA                   |   1996 | 461217420.131622
 ALGERIA                   |   1995 | 463388504.783911
 ALGERIA                   |   1994 | 456109500.916431
 ALGERIA                   |   1993 | 465571366.919284
 ALGERIA                   |   1992 | 472264795.357151
 ARGENTINA                 |   1998 |  265932773.47352
 ARGENTINA                 |   1997 | 464387635.669221
 ARGENTINA                 |   1996 | 465227061.377899
 ARGENTINA                 |   1995 | 464634212.669619
 ARGENTINA                 |   1994 | 461453301.479511
 ARGENTINA                 |   1993 | 459493524.249096
 ARGENTINA                 |   1992 | 460460045.434436
 BRAZIL                    |   1998 | 275099208.295434
 BRAZIL                    |   1997 | 470727757.107969
 BRAZIL                    |   1996 |  462048963.72608
 BRAZIL                    |   1995 | 470314100.474984
 BRAZIL                    |   1994 | 467668698.941598
 BRAZIL                    |   1993 | 465814541.617374
 BRAZIL                    |   1992 | 467317813.343656
 CANADA                    |   1998 | 274203554.482266
 CANADA                    |   1997 | 478008966.802658
 CANADA                    |   1996 | 482495183.514527
 CANADA                    |   1995 | 474969698.538763
 CANADA                    |   1994 | 484394095.227141
 CANADA                    |   1993 | 483899610.608494
 CANADA                    |   1992 | 485422361.868884
 CHINA                     |   1998 |  272704457.63235
 CHINA                     |   1997 | 466232010.017807
 CHINA                     |   1996 | 464479154.857119
 CHINA                     |   1995 | 470356258.123726
 CHINA                     |   1994 | 473066904.746777
 CHINA                     |   1993 | 466233120.478958
 CHINA                     |   1992 | 476938487.018166
 EGYPT                     |   1998 | 266730491.581312
 EGYPT                     |   1997 | 461196433.828543
 EGYPT                     |   1996 | 460567639.192275
 EGYPT                     |   1995 | 458471639.880688
 EGYPT                     |   1994 | 454462529.291885
 EGYPT                     |   1993 | 467426384.986135
 EGYPT                     |   1992 | 461769702.955537
 ETHIOPIA                  |   1998 |  267439449.34919
 ETHIOPIA                  |   1997 | 460979201.601614
 ETHIOPIA                  |   1996 |  464061855.09547
 ETHIOPIA                  |   1995 |   469870421.0279
 ETHIOPIA                  |   1994 | 468001842.251787
 ETHIOPIA                  |   1993 | 466144918.402425
 ETHIOPIA                  |   1992 | 464455375.896338
 FRANCE                    |   1998 | 271268631.329999
 FRANCE                    |   1997 | 469367526.180531
 FRANCE                    |   1996 | 467279717.317572
 FRANCE                    |   1995 | 474168810.694916
 FRANCE                    |   1994 | 466046968.316851
 FRANCE                    |   1993 | 463768245.403201
 FRANCE                    |   1992 | 465399582.389462
 GERMANY                   |   1998 | 279721173.942074
 GERMANY                   |   1997 | 482948098.237029
 GERMANY                   |   1996 | 477644284.510914
 GERMANY                   |   1995 | 481314782.368515
 GERMANY                   |   1994 | 474224364.309083
 GERMANY                   |   1993 |  475079822.59125
 GERMANY                   |   1992 | 474123611.633109
 INDIA                     |   1998 | 281232599.187835
 INDIA                     |   1997 |  477682658.91589
 INDIA                     |   1996 | 481381438.444552
 INDIA                     |   1995 | 475588284.942593
 INDIA                     |   1994 | 484815763.187569
 INDIA                     |   1993 | 473208270.478765
 INDIA                     |   1992 | 486182610.299583
 INDONESIA                 |   1998 | 272699874.905682
 INDONESIA                 |   1997 | 475677308.268386
 INDONESIA                 |   1996 | 468723636.220437
 INDONESIA                 |   1995 | 462535302.824051
 INDONESIA                 |   1994 | 470143389.660101
 INDONESIA                 |   1993 | 464198302.907797
 INDONESIA                 |   1992 | 464106826.614336
 IRAN                      |   1998 | 273502286.119101
 IRAN                      |   1997 | 469003087.262214
 IRAN                      |   1996 | 463415778.098892
 IRAN                      |   1995 | 472257261.638558
 IRAN                      |   1994 |  470451755.13432
 IRAN                      |   1993 | 465446616.187968
 IRAN                      |   1992 | 467509308.292322
 IRAQ                      |   1998 | 278651941.215521
 IRAQ                      |   1997 | 480935959.827227
 IRAQ                      |   1996 | 477058827.095168
 IRAQ                      |   1995 | 475749276.602715
 IRAQ                      |   1994 | 482824306.300885
 IRAQ                      |   1993 | 479832426.659444
 IRAQ                      |   1992 | 477375859.492918
 JAPAN                     |   1998 | 275351613.850819
 JAPAN                     |   1997 | 465938639.921634
 JAPAN                     |   1996 | 473154320.100474
 JAPAN                     |   1995 | 472104670.558057
 JAPAN                     |   1994 | 466109137.777649
 JAPAN                     |   1993 | 471022762.633942
 JAPAN                     |   1992 | 464431482.286817
 JORDAN                    |   1998 | 268828232.185765
 JORDAN                    |   1997 | 465783791.717631
 JORDAN                    |   1996 | 458041867.006609
 JORDAN                    |   1995 |   462691558.5991
 JORDAN                    |   1994 | 462201538.000094
 JORDAN                    |   1993 | 456694441.242921
 JORDAN                    |   1992 | 464602058.867075
 KENYA                     |   1998 | 272166284.812132
 KENYA                     |   1997 | 467512105.634014
 KENYA                     |   1996 |  467913364.76371
 KENYA                     |   1995 | 461833929.191575
 KENYA                     |   1994 | 466855196.874544
 KENYA                     |   1993 | 465978462.343628
 KENYA                     |   1992 | 466801098.898363
 MOROCCO                   |   1998 | 272249307.290718
 MOROCCO                   |   1997 | 468495450.358317
 MOROCCO                   |   1996 | 473300696.408417
 MOROCCO                   |   1995 | 466683982.358899
 MOROCCO                   |   1994 | 465209360.450528
 MOROCCO                   |   1993 | 465525061.866027
 MOROCCO                   |   1992 | 464486528.594967
 MOZAMBIQUE                |   1998 | 270260618.551876
 MOZAMBIQUE                |   1997 | 460623433.663936
 MOZAMBIQUE                |   1996 |   462623944.0712
 MOZAMBIQUE                |   1995 | 463857922.863119
 MOZAMBIQUE                |   1994 | 457830923.558426
 MOZAMBIQUE                |   1993 | 460790935.592431
 MOZAMBIQUE                |   1992 | 461868147.973293
 PERU                      |   1998 | 272670841.933042
 PERU                      |   1997 | 465010670.401734
 PERU                      |   1996 | 458786511.327446
 PERU                      |   1995 | 461038846.556186
 PERU                      |   1994 | 461288578.335411
 PERU                      |   1993 |  462574347.55452
 PERU                      |   1992 | 471659598.024221
 ROMANIA                   |   1998 | 283128683.754311
 ROMANIA                   |   1997 | 480869484.453199
 ROMANIA                   |   1996 | 475707372.477752
 ROMANIA                   |   1995 | 481109375.137958
 ROMANIA                   |   1994 |  483698661.15543
 ROMANIA                   |   1993 | 481874506.133538
 ROMANIA                   |   1992 | 472723533.485936
 RUSSIA                    |   1998 | 273776905.883742
 RUSSIA                    |   1997 | 468683243.097945
 RUSSIA                    |   1996 | 471735436.639381
 RUSSIA                    |   1995 | 477432936.347291
 RUSSIA                    |   1994 | 467910807.228033
 RUSSIA                    |   1993 | 472239579.862412
 RUSSIA                    |   1992 | 472240195.552364
 SAUDI ARABIA              |   1998 | 275265339.405365
 SAUDI ARABIA              |   1997 | 473485927.824423
 SAUDI ARABIA              |   1996 | 462835313.523321
 SAUDI ARABIA              |   1995 | 471588991.886766
 SAUDI ARABIA              |   1994 | 469539175.797781
 SAUDI ARABIA              |   1993 | 468831602.351143
 SAUDI ARABIA              |   1992 | 483566481.972036
 UNITED KINGDOM            |   1998 | 274323943.299956
 UNITED KINGDOM            |   1997 | 471161385.836715
 UNITED KINGDOM            |   1996 | 469247502.356421
 UNITED KINGDOM            |   1995 | 459366652.732928
 UNITED KINGDOM            |   1994 |  463559850.32484
 UNITED KINGDOM            |   1993 | 466284667.269085
 UNITED KINGDOM            |   1992 | 469979935.521473
 UNITED STATES             |   1998 | 277022126.263208
 UNITED STATES             |   1997 | 474655864.347208
 UNITED STATES             |   1996 | 474646331.499947
 UNITED STATES             |   1995 | 470781397.693349
 UNITED STATES             |   1994 | 474169597.655269
 UNITED STATES             |   1993 | 463009635.319508
 UNITED STATES             |   1992 | 459503389.058106
 VIETNAM                   |   1998 | 270840243.161245
 VIETNAM                   |   1997 | 465607546.139293
 VIETNAM                   |   1996 | 473668493.922424
 VIETNAM                   |   1995 | 479868610.676648
 VIETNAM                   |   1994 | 470718789.305375
 VIETNAM                   |   1993 | 473627751.742331
 VIETNAM                   |   1992 | 472511802.728513
(175 rows)

COMMIT;
COMMIT
