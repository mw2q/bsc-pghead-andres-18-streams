BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%mint%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264830090.112823
 ALGERIA                   |   1997 | 457151977.215717
 ALGERIA                   |   1996 | 462037390.799303
 ALGERIA                   |   1995 | 465692599.258845
 ALGERIA                   |   1994 | 454440788.690988
 ALGERIA                   |   1993 | 460831403.932911
 ALGERIA                   |   1992 | 457821787.032691
 ARGENTINA                 |   1998 | 271819352.471385
 ARGENTINA                 |   1997 | 467351495.593788
 ARGENTINA                 |   1996 | 472704161.863719
 ARGENTINA                 |   1995 | 470992981.037046
 ARGENTINA                 |   1994 | 466335214.182706
 ARGENTINA                 |   1993 | 462361077.465521
 ARGENTINA                 |   1992 | 465608540.184951
 BRAZIL                    |   1998 | 275452787.707493
 BRAZIL                    |   1997 | 473894035.937514
 BRAZIL                    |   1996 | 471685142.374151
 BRAZIL                    |   1995 | 471301499.906974
 BRAZIL                    |   1994 | 468936409.239331
 BRAZIL                    |   1993 | 473611978.514796
 BRAZIL                    |   1992 | 467065357.142251
 CANADA                    |   1998 |  273697892.93179
 CANADA                    |   1997 | 477624162.576742
 CANADA                    |   1996 | 480061966.949549
 CANADA                    |   1995 | 473585761.086392
 CANADA                    |   1994 | 476948815.311463
 CANADA                    |   1993 | 475992364.476513
 CANADA                    |   1992 | 475409095.840288
 CHINA                     |   1998 | 270077721.396053
 CHINA                     |   1997 | 466140269.883185
 CHINA                     |   1996 | 460306655.357602
 CHINA                     |   1995 | 461562458.694451
 CHINA                     |   1994 | 462577236.554496
 CHINA                     |   1993 | 461970797.654948
 CHINA                     |   1992 | 465139519.560613
 EGYPT                     |   1998 | 271386947.636338
 EGYPT                     |   1997 | 459185689.128678
 EGYPT                     |   1996 | 461848058.847431
 EGYPT                     |   1995 | 455662589.016149
 EGYPT                     |   1994 | 456270377.127913
 EGYPT                     |   1993 | 470762118.185464
 EGYPT                     |   1992 | 460023836.253239
 ETHIOPIA                  |   1998 |  268529549.51898
 ETHIOPIA                  |   1997 | 444704516.552434
 ETHIOPIA                  |   1996 | 457235120.667089
 ETHIOPIA                  |   1995 | 462276059.461283
 ETHIOPIA                  |   1994 | 463345578.944788
 ETHIOPIA                  |   1993 |   449980496.2378
 ETHIOPIA                  |   1992 | 458587223.555651
 FRANCE                    |   1998 | 265478685.400546
 FRANCE                    |   1997 | 462898805.323509
 FRANCE                    |   1996 | 462484099.744727
 FRANCE                    |   1995 | 461482292.590723
 FRANCE                    |   1994 | 469792749.018164
 FRANCE                    |   1993 | 461712883.674044
 FRANCE                    |   1992 | 466437551.534833
 GERMANY                   |   1998 | 277356536.119934
 GERMANY                   |   1997 | 482135487.775516
 GERMANY                   |   1996 | 482120938.612071
 GERMANY                   |   1995 |   473857356.7117
 GERMANY                   |   1994 | 472133342.079626
 GERMANY                   |   1993 | 473390948.407691
 GERMANY                   |   1992 | 476115398.735719
 INDIA                     |   1998 |  279441797.12508
 INDIA                     |   1997 |   473171070.0845
 INDIA                     |   1996 | 475626297.786646
 INDIA                     |   1995 |  475168482.62613
 INDIA                     |   1994 | 474816238.677661
 INDIA                     |   1993 |  471928726.48886
 INDIA                     |   1992 | 483263639.359117
 INDONESIA                 |   1998 | 271038610.661351
 INDONESIA                 |   1997 | 458851556.576167
 INDONESIA                 |   1996 | 468531675.921477
 INDONESIA                 |   1995 | 452760141.942924
 INDONESIA                 |   1994 | 458951734.992523
 INDONESIA                 |   1993 | 458678213.806169
 INDONESIA                 |   1992 | 459164372.644371
 IRAN                      |   1998 | 266343757.354596
 IRAN                      |   1997 | 456002800.361959
 IRAN                      |   1996 | 462112541.570309
 IRAN                      |   1995 | 453007289.836484
 IRAN                      |   1994 | 457244002.245108
 IRAN                      |   1993 | 459915941.154625
 IRAN                      |   1992 | 461471549.290225
 IRAQ                      |   1998 | 272668011.111567
 IRAQ                      |   1997 | 465049896.323775
 IRAQ                      |   1996 |  469402005.96645
 IRAQ                      |   1995 |  465386776.32414
 IRAQ                      |   1994 | 475417884.382622
 IRAQ                      |   1993 |  466370159.50612
 IRAQ                      |   1992 | 466641372.368833
 JAPAN                     |   1998 | 270853979.275739
 JAPAN                     |   1997 | 460092722.782211
 JAPAN                     |   1996 | 460000577.311412
 JAPAN                     |   1995 | 467106660.434644
 JAPAN                     |   1994 | 459798359.808957
 JAPAN                     |   1993 | 463276314.208334
 JAPAN                     |   1992 | 464775343.147718
 JORDAN                    |   1998 | 273830955.512424
 JORDAN                    |   1997 | 456548344.054068
 JORDAN                    |   1996 | 460374668.438352
 JORDAN                    |   1995 | 460331566.120625
 JORDAN                    |   1994 | 459988017.421083
 JORDAN                    |   1993 | 458140297.326538
 JORDAN                    |   1992 | 450834436.214018
 KENYA                     |   1998 |  280197620.82867
 KENYA                     |   1997 | 474136912.473521
 KENYA                     |   1996 | 481748085.444071
 KENYA                     |   1995 | 469614043.027062
 KENYA                     |   1994 | 484897228.570003
 KENYA                     |   1993 | 470183512.839304
 KENYA                     |   1992 | 473028573.985427
 MOROCCO                   |   1998 | 270372930.807249
 MOROCCO                   |   1997 | 446688060.293129
 MOROCCO                   |   1996 | 457358770.950126
 MOROCCO                   |   1995 | 468741916.194991
 MOROCCO                   |   1994 | 458738867.198914
 MOROCCO                   |   1993 |  455941357.31723
 MOROCCO                   |   1992 | 462787280.279853
 MOZAMBIQUE                |   1998 | 274104760.661095
 MOZAMBIQUE                |   1997 | 458676869.692539
 MOZAMBIQUE                |   1996 | 468096266.845094
 MOZAMBIQUE                |   1995 | 463932719.968341
 MOZAMBIQUE                |   1994 | 465531458.144905
 MOZAMBIQUE                |   1993 |   471137575.0939
 MOZAMBIQUE                |   1992 | 463095463.981053
 PERU                      |   1998 | 273119874.318412
 PERU                      |   1997 | 473479392.223482
 PERU                      |   1996 | 469313223.501141
 PERU                      |   1995 | 467713432.166781
 PERU                      |   1994 | 471586074.666419
 PERU                      |   1993 | 464094210.219247
 PERU                      |   1992 | 466766270.412148
 ROMANIA                   |   1998 | 276783192.970182
 ROMANIA                   |   1997 | 465437966.866668
 ROMANIA                   |   1996 | 471781318.239919
 ROMANIA                   |   1995 | 468977186.514906
 ROMANIA                   |   1994 | 468355557.171385
 ROMANIA                   |   1993 | 475545885.178176
 ROMANIA                   |   1992 | 469842340.893728
 RUSSIA                    |   1998 | 273671053.467658
 RUSSIA                    |   1997 | 460993432.301686
 RUSSIA                    |   1996 | 471489504.976916
 RUSSIA                    |   1995 | 460645730.849412
 RUSSIA                    |   1994 | 460936746.606806
 RUSSIA                    |   1993 | 469703341.910832
 RUSSIA                    |   1992 | 460213724.584371
 SAUDI ARABIA              |   1998 | 270315904.598771
 SAUDI ARABIA              |   1997 | 475562765.585554
 SAUDI ARABIA              |   1996 | 465860958.529436
 SAUDI ARABIA              |   1995 | 470553118.084562
 SAUDI ARABIA              |   1994 | 467309194.317238
 SAUDI ARABIA              |   1993 | 473597661.157213
 SAUDI ARABIA              |   1992 | 474038575.458277
 UNITED KINGDOM            |   1998 | 265856851.224991
 UNITED KINGDOM            |   1997 | 460865938.282165
 UNITED KINGDOM            |   1996 | 449006978.635539
 UNITED KINGDOM            |   1995 | 458404545.307885
 UNITED KINGDOM            |   1994 | 453367967.420091
 UNITED KINGDOM            |   1993 | 455841869.336964
 UNITED KINGDOM            |   1992 | 456689700.688076
 UNITED STATES             |   1998 | 283934136.895779
 UNITED STATES             |   1997 | 481296153.816613
 UNITED STATES             |   1996 | 475256802.377076
 UNITED STATES             |   1995 | 472713608.276863
 UNITED STATES             |   1994 | 482593771.760018
 UNITED STATES             |   1993 | 476485573.038839
 UNITED STATES             |   1992 | 471778604.213198
 VIETNAM                   |   1998 | 278757817.680802
 VIETNAM                   |   1997 | 464523655.721644
 VIETNAM                   |   1996 | 466192895.906904
 VIETNAM                   |   1995 | 466804959.653999
 VIETNAM                   |   1994 | 470283182.569101
 VIETNAM                   |   1993 | 466502844.364424
 VIETNAM                   |   1992 | 468754973.422047
(175 rows)

COMMIT;
COMMIT
